{
  "widgets": [
    {
      "type": "metric",
      "x": 0,
      "y": 0,
      "width": 12,
      "height": 6,
      "properties": {
        "metrics": [
          [ "AWS/EC2", "CPUUtilization", { "stat": "Average", "label": "Avg CPU" } ],
          [ "...", { "stat": "Maximum", "label": "Max CPU" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "EC2 CPU Utilization",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "max": 100,
            "label": "Percent"
          }
        },
        "annotations": {
          "horizontal": [
            {
              "label": "High CPU Threshold",
              "value": 80,
              "fill": "above",
              "color": "#d62728"
            }
          ]
        }
      }
    },
    {
      "type": "metric",
      "x": 12,
      "y": 0,
      "width": 12,
      "height": 6,
      "properties": {
        "metrics": [
          [ "${namespace}", "mem_used_percent", { "stat": "Average", "label": "Avg Memory" } ],
          [ "...", { "stat": "Maximum", "label": "Max Memory" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "Memory Utilization",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "max": 100,
            "label": "Percent"
          }
        },
        "annotations": {
          "horizontal": [
            {
              "label": "High Memory Threshold",
              "value": 85,
              "fill": "above",
              "color": "#d62728"
            }
          ]
        }
      }
    },
    {
      "type": "metric",
      "x": 0,
      "y": 6,
      "width": 12,
      "height": 6,
      "properties": {
        "metrics": [
          [ "${namespace}", "disk_free_percent", { "stat": "Average", "label": "Avg Free Space" } ],
          [ "...", { "stat": "Minimum", "label": "Min Free Space" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "Disk Space Available",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "max": 100,
            "label": "Percent Free"
          }
        },
        "annotations": {
          "horizontal": [
            {
              "label": "Low Disk Space Threshold",
              "value": 15,
              "fill": "below",
              "color": "#d62728"
            }
          ]
        }
      }
    },
    {
      "type": "metric",
      "x": 12,
      "y": 6,
      "width": 12,
      "height": 6,
      "properties": {
        "metrics": [
          [ "AWS/ApplicationELB", "HealthyHostCount", { "stat": "Average" } ],
          [ ".", "UnHealthyHostCount", { "stat": "Maximum", "color": "#d62728" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "Target Group Health",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "label": "Host Count"
          }
        }
      }
    },
    {
      "type": "metric",
      "x": 0,
      "y": 12,
      "width": 8,
      "height": 6,
      "properties": {
        "metrics": [
          [ "AWS/ApplicationELB", "RequestCount", { "stat": "Sum", "label": "Total Requests" } ],
          [ ".", "HTTPCode_Target_2XX_Count", { "stat": "Sum", "label": "2XX Responses", "color": "#2ca02c" } ],
          [ ".", "HTTPCode_Target_4XX_Count", { "stat": "Sum", "label": "4XX Responses", "color": "#ff7f0e" } ],
          [ ".", "HTTPCode_Target_5XX_Count", { "stat": "Sum", "label": "5XX Responses", "color": "#d62728" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "HTTP Response Codes",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "label": "Count"
          }
        }
      }
    },
    {
      "type": "metric",
      "x": 8,
      "y": 12,
      "width": 8,
      "height": 6,
      "properties": {
        "metrics": [
          [ "AWS/ApplicationELB", "TargetResponseTime", { "stat": "Average", "label": "Avg Response Time" } ],
          [ "...", { "stat": "p99", "label": "p99 Response Time" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "Response Time",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "label": "Seconds"
          }
        }
      }
    },
    {
      "type": "metric",
      "x": 16,
      "y": 12,
      "width": 8,
      "height": 6,
      "properties": {
        "metrics": [
          [ "${namespace}", "ErrorCount", { "stat": "Sum", "label": "Application Errors" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "Application Error Rate",
        "period": 60,
        "yAxis": {
          "left": {
            "min": 0,
            "label": "Errors per Minute"
          }
        },
        "annotations": {
          "horizontal": [
            {
              "label": "Error Threshold",
              "value": 10,
              "fill": "above",
              "color": "#d62728"
            }
          ]
        }
      }
    },
    {
      "type": "log",
      "x": 0,
      "y": 18,
      "width": 12,
      "height": 6,
      "properties": {
        "query": "SOURCE '${app_log_group}'\n| fields @timestamp, @message\n| filter @message like /ERROR/\n| sort @timestamp desc\n| limit 20",
        "region": "${region}",
        "stacked": false,
        "title": "Recent Application Errors",
        "view": "table"
      }
    },
    {
      "type": "log",
      "x": 12,
      "y": 18,
      "width": 12,
      "height": 6,
      "properties": {
        "query": "SOURCE '${security_log_group}'\n| fields @timestamp, @message\n| filter @message like /CRITICAL/\n| sort @timestamp desc\n| limit 20",
        "region": "${region}",
        "stacked": false,
        "title": "Critical Security Events",
        "view": "table"
      }
    },
    {
      "type": "metric",
      "x": 0,
      "y": 24,
      "width": 6,
      "height": 6,
      "properties": {
        "metrics": [
          [ "AWS/EC2", "NetworkIn", { "stat": "Sum", "label": "Network In" } ],
          [ ".", "NetworkOut", { "stat": "Sum", "label": "Network Out" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "Network Traffic",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "label": "Bytes"
          }
        }
      }
    },
    {
      "type": "metric",
      "x": 6,
      "y": 24,
      "width": 6,
      "height": 6,
      "properties": {
        "metrics": [
          [ "AWS/EC2", "DiskReadBytes", { "stat": "Sum", "label": "Disk Read" } ],
          [ ".", "DiskWriteBytes", { "stat": "Sum", "label": "Disk Write" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "Disk I/O",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "label": "Bytes"
          }
        }
      }
    },
    {
      "type": "metric",
      "x": 12,
      "y": 24,
      "width": 6,
      "height": 6,
      "properties": {
        "metrics": [
          [ "AWS/ApplicationELB", "ActiveConnectionCount", { "stat": "Sum", "label": "Active Connections" } ],
          [ ".", "NewConnectionCount", { "stat": "Sum", "label": "New Connections" } ]
        ],
        "view": "timeSeries",
        "stacked": false,
        "region": "${region}",
        "title": "Load Balancer Connections",
        "period": 300,
        "yAxis": {
          "left": {
            "min": 0,
            "label": "Count"
          }
        }
      }
    },
    {
      "type": "metric",
      "x": 18,
      "y": 24,
      "width": 6,
      "height": 6,
      "properties": {
        "metrics": [
          [ "${namespace}", "SecurityEvents", { "stat": "Sum", "label": "Security Events", "color": "#d62728" } ]
        ],
        "view": "singleValue",
        "region": "${region}",
        "title": "Critical Security Events (Last Hour)",
        "period": 3600,
        "setPeriodToTimeRange": false
      }
    },
    {
      "type": "alarm",
      "x": 0,
      "y": 30,
      "width": 24,
      "height": 4,
      "properties": {
        "title": "Active Alarms",
        "alarms": [
          "arn:aws:cloudwatch:${region}:*:alarm:${environment}-*"
        ]
      }
    }
  ]
}
